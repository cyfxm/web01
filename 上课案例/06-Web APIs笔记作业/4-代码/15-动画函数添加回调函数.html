<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        *{
            margin: 0;
            padding: 0;
        }
        div{
            width: 100px;
            height: 100px;
            background: pink;
            /* 设置绝对定位 */
            position: absolute;
            left: 0;
            top: 0;
        }
        button{
            margin-top: 200px;
        }
    </style>
</head>
<body>
    <div>下冰雹</div>
    <button>点我开始运动</button>

    <script>
        // 动画函数添加回调函数
        // 回调函数原理:函数也可以作为一个形式参数传递给其他函数。将这个函数作为参数传到另一个函数里面，当那个函数执行完之后，再执行传进去的这个函数，这个过程就叫做回调。
        // 回调函数写的位置:定时器结束的位置。

        // 动画函数
        function animate(obj,target,callback){
            // 先清除定时器
            clearInterval( obj.timer );
           
           // 再开启定时器,让对象开始移动
           obj.timer = setInterval(function(){
                // 定义一个变量 step 保存对象每次移动的速度  这个step我们也会叫步长值
                var step = (target - obj.offsetLeft)/10;

                // 步长值是正值向上取整    步长值是负值向下取整
                step = step > 0  ? Math.ceil( step ) : Math.floor( step ) ;
                
                if(obj.offsetLeft == target){
                    // 到达目标值的时候,清除定时器
                    clearInterval( obj.timer );

                    // console.log( callback );
                    // 因为不一定每次调用animate都需要回调函数
                    if( callback ){// 判断callback参数是否存在,不存在默认callback为undefined
                        callback();// 调用callback函数
                    }

                }else{
                    obj.style.left = obj.offsetLeft + step + "px";
                }
            },15);
        }

        // 获取div对象
        var div = document.querySelector("div");
        // 获取所有的按钮对象
        var btn = document.querySelector("button");
        btn.onclick = function(){
            // 要求:点击按钮,然后元素开始移动,移动到目标值以后,改变元素的背景颜色为红色
            // animate( div, 500 );

            // 在调用animate的时候,可以给第三个参数参一个匿名函数
            animate( div, 500 , function(){
                // 改变div的背景颜色
                div.style.backgroundColor = "red";
            });
        }
    </script>
</body>
</html>