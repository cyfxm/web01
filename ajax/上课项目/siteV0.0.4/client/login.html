<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>登录页面</title>
    <style>
        .wrong {
            color:red;
        }
    </style>
</head>
<body>
    <h1>用户登录</h1>
    <div class="info">
        <div>
            <input type="text" id="username" placeholder="账号"> <span class="text wrong"></span>
        </div>
        <div>
            <input type="text" id="password" placeholder="密码">  <span class="text wrong"></span>
        </div>
        <div>
            <button id="login_btn">登录</button>
        </div>
    </div>
    <div class="message"></div>


    <!-- 该页面不可以双击html文件打开，需要在指定服务下打开 -->
    <!-- http://127.0.0.1:3005/login.html -->
    <!-- 因为不是表单提交数据，是ajax提交数据 -->
</body>
</html>
<script src="./js/ajaxV0.0.2.js"></script>
<script>
    // 老三步
        // 1.0 获取相关元素
        var username_ele = document.getElementById("username");
        var password_ele = document.getElementById("password");
        var login_btn = document.getElementById("login_btn");
        var message_ele =  document.getElementsByClassName("message")[0];

        // 2.0 事件的绑定
        login_btn.onclick = function(){
            // 3.0 获取输入框的值
            var v1 = username_ele.value;
            var v2 = password_ele.value;
            // console.log(v1,v2)
            // 3.0.1 判断
            if(v1.length == 0 || v2.length == 0 ){
                alert("请输入信息");
                return ;
            }
            // 登录的接口
            // 接口地址：http://127.0.0.1:3005/login
            // 请求方式：post
            // 参数：
            //    属性       数据类型   是否必须填写
            //    username    string     是
            //    password    string     是
            // 返回值：
            // 3.0.2 执行ajax
            $.ajax({
                url:"http://127.0.0.1:3005/login",
                type:"post",
                async:true,
                data:{
                    username:v1,
                    password:v2
                },
                success:function(res){
                    console.log(res);
                    // 渲染数据
                    if(res.code  == 0 ){
                        message_ele.innerHTML = res.message;//登陆成功
                    }else if (res.code  == -2){
                        username_ele.nextElementSibling.innerHTML = res.message;//账号错误
                    }else if (res.code  == -1){
                        password_ele.nextElementSibling.innerHTML = res.message;//密码错误
                    }
                },
                error:function(err){
                    console.log(err);
                }
            })
        }



</script>